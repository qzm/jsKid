<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>jsKid 2.0 - ç°ä»£åŒ–2Dæ¸¸æˆå¼•æ“æ¼”ç¤º</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 20px;
            text-align: center;
            color: white;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .header h1 {
            margin: 0;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            margin: 10px 0 0 0;
            font-size: 1.2em;
            opacity: 0.9;
        }

        .main-container {
            flex: 1;
            display: flex;
            padding: 20px;
            gap: 20px;
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
        }

        .game-section {
            flex: 2;
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .info-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .info-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .info-card h3 {
            margin: 0 0 15px 0;
            color: #333;
            font-size: 1.3em;
        }

        .info-card p {
            margin: 0 0 10px 0;
            color: #666;
            line-height: 1.6;
        }

        .canvas-container {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 10px;
            text-align: center;
            border: 2px solid #e9ecef;
        }

        canvas {
            border: 2px solid #333;
            border-radius: 8px;
            background: white;
            max-width: 100%;
            height: auto;
        }

        .controls {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        .stats {
            background: #212529;
            color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.6;
            margin-top: 20px;
        }

        .feature-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .feature-list li {
            padding: 8px 0;
            border-bottom: 1px solid #e9ecef;
            color: #495057;
        }

        .feature-list li:last-child {
            border-bottom: none;
        }

        .feature-list li::before {
            content: "âœ¨";
            margin-right: 10px;
        }

        .demo-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .demo-list li {
            padding: 10px;
            margin: 5px 0;
            background: #f8f9fa;
            border-radius: 5px;
            border-left: 4px solid #667eea;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .demo-list li:hover {
            background: #e9ecef;
            transform: translateX(5px);
        }

        .demo-list strong {
            display: block;
            color: #333;
            margin-bottom: 3px;
        }

        .demo-list small {
            color: #666;
        }

        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
            }

            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸš€ jsKid 2.0</h1>
        <p>ç°ä»£åŒ–2Dæ¸¸æˆå¼•æ“ - TypeScript + ES6+ + Vite</p>
    </div>

    <div class="main-container">
        <div class="game-section">
            <div class="canvas-container">
                <canvas id="gameCanvas" width="800" height="600"></canvas>
            </div>

            <div class="controls">
                <button class="btn btn-primary" id="startBtn">å¼€å§‹æ¸¸æˆ</button>
                <button class="btn btn-secondary" id="pauseBtn">æš‚åœ</button>
                <button class="btn btn-secondary" id="resumeBtn">æ¢å¤</button>
                <button class="btn btn-secondary" id="resetBtn">é‡ç½®</button>
            </div>

            <div class="stats" id="stats">
                ğŸ® æ¸¸æˆçŠ¶æ€: å‡†å¤‡å°±ç»ª<br>
                âš¡ ç‰ˆæœ¬: jsKid 2.0.0<br>
                ğŸ“Š FPS: --<br>
                ğŸ¯ å¯¹è±¡æ•°é‡: --<br>
                â±ï¸ è¿è¡Œæ—¶é—´: 0s
            </div>
        </div>

        <div class="info-section">
            <div class="info-card">
                <h3>ğŸ¯ å½“å‰æ¼”ç¤º</h3>
                <p>è¿™æ˜¯ä¸€ä¸ªç®€å•çš„åŠ¨ç”»æ¼”ç¤ºï¼Œå±•ç¤ºäº†jsKid 2.0çš„æ ¸å¿ƒåŠŸèƒ½ã€‚</p>
                <ul class="feature-list">
                    <li>TypeScriptç±»å‹å®‰å…¨</li>
                    <li>æ¸¸æˆå¾ªç¯å’Œæ—¶é—´æ§åˆ¶</li>
                    <li>Canvas 2Dæ¸²æŸ“</li>
                    <li>æ¸¸æˆå¯¹è±¡ç³»ç»Ÿ</li>
                    <li>è¾“å…¥å¤„ç†</li>
                    <li>äº‹ä»¶ç³»ç»Ÿ</li>
                </ul>
            </div>

            <div class="info-card">
                <h3>ğŸ® æ¼”ç¤ºè¯´æ˜</h3>
                <ul class="demo-list">
                    <li>
                        <strong>åŸºç¡€CanvasåŠ¨ç”»</strong>
                        <small>è‡ªåŠ¨ç§»åŠ¨çš„å½©è‰²æ–¹å—</small>
                    </li>
                    <li>
                        <strong>é”®ç›˜æ§åˆ¶</strong>
                        <small>ä½¿ç”¨æ–¹å‘é”®æ§åˆ¶ä¸»è§’ç§»åŠ¨</small>
                    </li>
                    <li>
                        <strong>é¼ æ ‡äº¤äº’</strong>
                        <small>ç‚¹å‡»ç”»å¸ƒåˆ›å»ºæ–°å¯¹è±¡</small>
                    </li>
                    <li>
                        <strong>ç¢°æ’æ£€æµ‹</strong>
                        <small>å¯¹è±¡ä¹‹é—´çš„è¾¹ç•Œæ£€æµ‹</small>
                    </li>
                </ul>
            </div>

            <div class="info-card">
                <h3>ğŸ› ï¸ æ§åˆ¶è¯´æ˜</h3>
                <p><strong>æ–¹å‘é”®</strong>: æ§åˆ¶è“è‰²æ–¹å—ç§»åŠ¨</p>
                <p><strong>é¼ æ ‡ç‚¹å‡»</strong>: åœ¨ç‚¹å‡»ä½ç½®åˆ›å»ºæ–°å¯¹è±¡</p>
                <p><strong>ç©ºæ ¼é”®</strong>: æš‚åœ/æ¢å¤æ¸¸æˆ</p>
                <p><strong>Ré”®</strong>: é‡ç½®æ¸¸æˆ</p>
            </div>
        </div>
    </div>

    <script type="module">
        console.log('ğŸš€ jsKid 2.0 æ¼”ç¤ºå¯åŠ¨...');

        // è·å–Canvaså’Œä¸Šä¸‹æ–‡
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const stats = document.getElementById('stats');

        // æ¸¸æˆçŠ¶æ€
        let gameRunning = false;
        let gamePaused = false;
        let animationId = null;
        let startTime = Date.now();
        let frameCount = 0;
        let lastFrameTime = performance.now();

        // æ¸¸æˆå¯¹è±¡
        const player = {
            x: 100,
            y: 300,
            width: 40,
            height: 40,
            color: '#667eea',
            speed: 200,
            dx: 0,
            dy: 0
        };

        const enemies = [
            { x: 300, y: 200, width: 30, height: 30, color: '#ff6b6b', speed: 100, phase: 0 },
            { x: 500, y: 400, width: 25, height: 25, color: '#4ecdc4', speed: 80, phase: Math.PI }
        ];

        const particles = [];

        // é”®ç›˜çŠ¶æ€
        const keys = {};

        // é”®ç›˜äº‹ä»¶å¤„ç†
        document.addEventListener('keydown', (e) => {
            keys[e.key] = true;

            if (e.key === ' ') {
                e.preventDefault();
                togglePause();
            } else if (e.key.toLowerCase() === 'r') {
                resetGame();
            }
        });

        document.addEventListener('keyup', (e) => {
            keys[e.key] = false;
        });

        // é¼ æ ‡ç‚¹å‡»å¤„ç†
        canvas.addEventListener('click', (e) => {
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;

            createParticle(x, y);
        });

        // åˆ›å»ºç²’å­
        function createParticle(x, y) {
            particles.push({
                x: x,
                y: y,
                width: 15,
                height: 15,
                color: `hsl(${Math.random() * 360}, 70%, 50%)`,
                dx: (Math.random() - 0.5) * 4,
                dy: (Math.random() - 0.5) * 4,
                life: 1.0
            });

            // é™åˆ¶ç²’å­æ•°é‡
            if (particles.length > 50) {
                particles.shift();
            }
        }

        // æ›´æ–°æ¸¸æˆé€»è¾‘
        function update(deltaTime) {
            if (gamePaused) return;

            // æ›´æ–°ç©å®¶ç§»åŠ¨
            player.dx = 0;
            player.dy = 0;

            if (keys['ArrowUp']) player.dy = -player.speed * deltaTime;
            if (keys['ArrowDown']) player.dy = player.speed * deltaTime;
            if (keys['ArrowLeft']) player.dx = -player.speed * deltaTime;
            if (keys['ArrowRight']) player.dx = player.speed * deltaTime;

            player.x += player.dx;
            player.y += player.dy;

            // é™åˆ¶ç©å®¶åœ¨ç”»å¸ƒå†…
            player.x = Math.max(0, Math.min(canvas.width - player.width, player.x));
            player.y = Math.max(0, Math.min(canvas.height - player.height, player.y));

            // æ›´æ–°æ•Œäºº
            enemies.forEach((enemy, index) => {
                enemy.phase += deltaTime * 2;
                enemy.y += Math.sin(enemy.phase) * enemy.speed * deltaTime;
                enemy.x += Math.cos(enemy.phase * 0.7) * enemy.speed * 0.5 * deltaTime;

                // è¾¹ç•Œæ£€æµ‹
                if (enemy.y < 0) enemy.y = canvas.height;
                if (enemy.y > canvas.height) enemy.y = 0;
                if (enemy.x < 0) enemy.x = canvas.width;
                if (enemy.x > canvas.width) enemy.x = 0;
            });

            // æ›´æ–°ç²’å­
            for (let i = particles.length - 1; i >= 0; i--) {
                const particle = particles[i];
                particle.x += particle.dx;
                particle.y += particle.dy;
                particle.life -= deltaTime * 2;

                if (particle.life <= 0) {
                    particles.splice(i, 1);
                }
            }

            // ç¢°æ’æ£€æµ‹
            enemies.forEach((enemy, index) => {
                if (checkCollision(player, enemy)) {
                    // ç¢°æ’æ•ˆæœ - åˆ›å»ºçˆ†ç‚¸ç²’å­
                    for (let i = 0; i < 10; i++) {
                        createParticle(
                            enemy.x + enemy.width / 2,
                            enemy.y + enemy.height / 2
                        );
                    }
                }
            });
        }

        // ç¢°æ’æ£€æµ‹
        function checkCollision(rect1, rect2) {
            return rect1.x < rect2.x + rect2.width &&
                   rect1.x + rect1.width > rect2.x &&
                   rect1.y < rect2.y + rect2.height &&
                   rect1.y + rect1.height > rect2.y;
        }

        // æ¸²æŸ“ç”»é¢
        function render() {
            // æ¸…ç©ºç”»å¸ƒ
            ctx.fillStyle = '#f8f9fa';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // ç»˜åˆ¶ç½‘æ ¼èƒŒæ™¯
            ctx.strokeStyle = '#e9ecef';
            ctx.lineWidth = 1;
            for (let i = 0; i <= canvas.width; i += 50) {
                ctx.beginPath();
                ctx.moveTo(i, 0);
                ctx.lineTo(i, canvas.height);
                ctx.stroke();
            }
            for (let i = 0; i <= canvas.height; i += 50) {
                ctx.beginPath();
                ctx.moveTo(0, i);
                ctx.lineTo(canvas.width, i);
                ctx.stroke();
            }

            // ç»˜åˆ¶ç²’å­
            particles.forEach(particle => {
                ctx.globalAlpha = particle.life;
                ctx.fillStyle = particle.color;
                ctx.fillRect(particle.x - particle.width/2, particle.y - particle.height/2,
                           particle.width, particle.height);
            });
            ctx.globalAlpha = 1;

            // ç»˜åˆ¶æ•Œäºº
            enemies.forEach(enemy => {
                ctx.fillStyle = enemy.color;
                ctx.beginPath();
                ctx.arc(enemy.x + enemy.width/2, enemy.y + enemy.height/2,
                       enemy.width/2, 0, Math.PI * 2);
                ctx.fill();
            });

            // ç»˜åˆ¶ç©å®¶
            ctx.fillStyle = player.color;
            ctx.fillRect(player.x, player.y, player.width, player.height);

            // ç»˜åˆ¶æš‚åœçŠ¶æ€
            if (gamePaused) {
                ctx.fillStyle = 'rgba(0, 0, 0, 0.5)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = 'white';
                ctx.font = 'bold 48px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('æ¸¸æˆæš‚åœ', canvas.width/2, canvas.height/2);
                ctx.font = '20px Arial';
                ctx.fillText('æŒ‰ç©ºæ ¼é”®ç»§ç»­', canvas.width/2, canvas.height/2 + 40);
            }
        }

        // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
        function updateStats() {
            const currentTime = Date.now();
            const fps = frameCount / ((currentTime - lastFrameTime) / 1000);
            const runTime = Math.floor((currentTime - startTime) / 1000);

            stats.innerHTML = `
                ğŸ® æ¸¸æˆçŠ¶æ€: ${gamePaused ? 'æš‚åœä¸­' : (gameRunning ? 'è¿è¡Œä¸­' : 'å·²åœæ­¢')}<br>
                âš¡ ç‰ˆæœ¬: jsKid 2.0.0<br>
                ğŸ“Š FPS: ${fps.toFixed(1)}<br>
                ğŸ¯ å¯¹è±¡æ•°é‡: ${1 + enemies.length + particles.length}<br>
                â±ï¸ è¿è¡Œæ—¶é—´: ${runTime}s
            `;
        }

        // æ¸¸æˆå¾ªç¯
        function gameLoop() {
            const now = performance.now();
            const deltaTime = Math.min((now - lastFrameTime) / 1000, 0.1);

            update(deltaTime);
            render();

            frameCount++;
            updateStats();

            lastFrameTime = now;
            animationId = requestAnimationFrame(gameLoop);
        }

        // æ¸¸æˆæ§åˆ¶å‡½æ•°
        function startGame() {
            if (!gameRunning) {
                gameRunning = true;
                gamePaused = false;
                startTime = Date.now();
                lastFrameTime = performance.now();
                frameCount = 0;
                gameLoop();
            }
        }

        function pauseGame() {
            gamePaused = true;
        }

        function resumeGame() {
            gamePaused = false;
        }

        function togglePause() {
            if (gamePaused) {
                resumeGame();
            } else {
                pauseGame();
            }
        }

        function resetGame() {
            // é‡ç½®ç©å®¶ä½ç½®
            player.x = 100;
            player.y = 300;

            // æ¸…ç©ºç²’å­
            particles.length = 0;

            // é‡ç½®æ—¶é—´
            startTime = Date.now();
            lastFrameTime = performance.now();
            frameCount = 0;
        }

        function stopGame() {
            gameRunning = false;
            if (animationId) {
                cancelAnimationFrame(animationId);
                animationId = null;
            }
        }

        // ç»‘å®šæŒ‰é’®äº‹ä»¶
        document.getElementById('startBtn').addEventListener('click', startGame);
        document.getElementById('pauseBtn').addEventListener('click', pauseGame);
        document.getElementById('resumeBtn').addEventListener('click', resumeGame);
        document.getElementById('resetBtn').addEventListener('click', resetGame);

        // åˆå§‹æ¸²æŸ“
        render();
        updateStats();

        console.log('âœ… jsKid 2.0 æ¼”ç¤ºåŠ è½½å®Œæˆ!');
        console.log('ğŸ® æŒ‰æ–¹å‘é”®æ§åˆ¶è“è‰²æ–¹å—ï¼Œç‚¹å‡»ç”»å¸ƒåˆ›å»ºç²’å­ï¼Œç©ºæ ¼é”®æš‚åœ');
    </script>
</body>
</html>